{% extends "admin/layout.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}

<h3>Welcome, {{ session.admin_name }} ðŸ‘‹</h3>

<!-- ===================== STAT CARDS ===================== -->
<div class="row mb-4">
  <div class="col-md-3">
    <div class="card shadow-sm p-3">
      <h6>Total Users</h6>
      <h3>{{ summary.total_users }}</h3>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card shadow-sm p-3">
      <h6>Average BMI</h6>
      <h3>{{ summary.avg_bmi }}</h3>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card shadow-sm p-3">
      <h6>Obesity</h6>
      <h3>{{ summary.obesity_count }}</h3>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card shadow-sm p-3">
      <h6>Posture Issues</h6>
      <h3>{{ summary.problematic_posture }}</h3>
    </div>
  </div>
</div>

<!-- ===================== CHART ROW 1 ===================== -->
<div class="row mb-4">
  <div class="col-md-6">
    <div class="card shadow-sm">
      <div class="card-header">Posture Distribution</div>
      <div class="card-body">
        <canvas id="posturePie"></canvas>
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <div class="card shadow-sm">
      <div class="card-header">New Users per Week</div>
      <div class="card-body">
        <canvas id="newUsersChart"></canvas>
      </div>
    </div>
  </div>
</div>

<!-- ===================== CHART ROW 2 ===================== -->
<div class="row">
  <div class="col-md-12">
    <div class="card shadow-sm">
      <div class="card-header">Global Posture Score Trend</div>
      <div class="card-body">
        <canvas id="postureScoreChart"></canvas>
      </div>
    </div>
  </div>
</div>

<!-- ===================== DATA TO JS ===================== -->
<!-- <script>
  const postureDistribution = {{ summary.posture_distribution | tojson }};
  const newUsersData = {{ new_users | tojson }};
  const postureScoreTrend = {{ posture_scores | tojson }};
</script> -->

<script>

  const postureDistribution = {
    normal: 50,
    kyphosis: 20,
    lordosis: 15,
    scoliosis: 10
  };

  const newUsersData = [
    { week: "W1", count: 5 },
    { week: "W2", count: 12 },
    { week: "W3", count: 9 },
    { week: "W4", count: 20 }
  ];

  const postureScoreTrend = [
    { date: "2025-01-01", score: 70 },
    { date: "2025-01-05", score: 75 },
    { date: "2025-01-10", score: 78 },
    { date: "2025-01-15", score: 82 },
    { date: "2025-01-20", score: 85 }
  ];

</script>


<!-- ===================== CHART.JS ===================== -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="{{ url_for('static', filename='js/main.js') }}"></script>

{% endblock %}
